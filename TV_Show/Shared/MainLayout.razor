@inherits LayoutComponentBase
@inject Blazored.LocalStorage.ILocalStorageService storage

<div class="sidebar">
    <NavMenu />
</div>

<div class="main">

    <div class="top-row px-4">
        @if (IsUserLogged)
        {
            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#modal"
                    @onclick="LogOut">
                Sign out
            </button>
        }
        else
        {
            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#modal"
                    style="margin-right:15px;" @onclick="LogIn">
                Sign in
            </button>
            @*<SignIn />*@
            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#modal"
                    style="margin-left:15px;" @onclick="Registration">
                Registration
            </button>
            <Registration />
        }
    </div>
    
    <div class="content px-4">
        @Body
        
    </div>
</div>

@code
{
    public bool IsUserLogged { get; set; }

    protected override async Task OnInitializedAsync()
    {
        //await storage.SetItemAsync<bool>("IsUserLogged", false);
        IsUserLogged = await storage.GetItemAsync<bool>("IsUserLogged");

    }

    async Task LogIn()
    {
        await storage.SetItemAsync<bool>("IsUserLogged", true);
        IsUserLogged = true;
    }

    async Task Registration()
    {
        await storage.SetItemAsync<bool>("IsUserLogged", true);
        IsUserLogged = true;
    }

    async Task LogOut()
    {
        await storage.SetItemAsync<bool>("IsUserLogged", false);
        IsUserLogged = false;
    }

}
